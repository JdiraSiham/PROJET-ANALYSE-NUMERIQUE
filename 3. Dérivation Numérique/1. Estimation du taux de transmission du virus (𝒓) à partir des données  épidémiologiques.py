import numpy as np 
import matplotlib.pyplot as plt 
Jours = np.array([1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 101, 111, 121, 131, 141, 151, 161, 171, 
181, 191, 201, 211, 221, 231, 241, 251, 261, 271, 281, 291, 301, 311, 321, 331, 341, 351, 361, 
371, 381, 391, 401, 411, 421, 431, 441, 451, 461, 471, 481, 491, 500]) 
I = np.array([1, 5, 86, 617, 1431, 3209, 4423, 6063, 7133, 7780, 8437, 9613, 12248, 14771, 
17236, 20278, 27217, 38805, 58489, 72394, 94504, 119107, 140024, 173632, 203733, 246349, 293177, 
340684, 376738, 406970, 430562, 443146, 456334, 469139, 478135, 480056, 482994, 485974, 488632, 
491463, 494659, 497832, 500948, 504260, 507938, 511562, 515023, 518868, 522765, 526651, 566356]) 
R = np.array([0, 1, 3, 24, 105, 393, 984, 2554, 4098, 5401, 7493, 8117, 8740, 11316, 14921, 
16438, 19629, 26687, 43049, 55274, 74930, 97468, 118142, 143972, 168706, 202491, 238276, 289808, 
327693, 365036, 396276, 415829, 431167, 445250, 456032, 463271, 468387, 470425, 472991, 475911, 
482352, 484793, 487414, 490366, 493873, 497382, 503483, 507681, 511842, 513681, 536626]) 
D = np.array([0, 1, 3, 36, 105, 145, 170, 188, 194, 204, 210, 213, 224, 242, 273, 313, 417, 584, 
1052, 1361, 1714, 2113, 2439, 2928, 3445, 4079, 4829, 5619, 6184, 6740, 7240, 7485, 7784, 8224, 
8466, 8540, 8608, 8653, 8693, 8745, 8798, 8842, 8882, 8940, 9000, 9060, 9104, 9160, 9220, 9238, 
9498]) 
N = 36_000_000 
a = 0.014057 
b = 0.004022 
I_prop = I / N 
R_prop = R / N 
D_prop = D / N 
S_prop = 1 - I_prop - R_prop - D_prop 
dI_dt = np.diff(I_prop) / np.diff(Jours) 
t_mid = (Jours[:-1] + Jours[1:]) / 2 
I_mid = (I_prop[:-1] + I_prop[1:]) / 2 
S_mid = (S_prop[:-1] + S_prop[1:]) / 2 
r_t = (dI_dt + (a + b) * I_mid) / (S_mid * I_mid) 
r_avg = np.mean(r_t) 
print(f"Valeur moyenne de r: {r_avg:.5f}") 
